{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '42087776-9136d7523d21dc11bf8e1a72d';\n\nconst form = document.querySelector('.form');\nconst list = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.button');\n\nform.addEventListener('submit', handleSearch);\nloader.classList.remove('loader');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst queryParams = {\n  query: '',\n  page: 1,\n  per_page: 40,\n  maxPage: 0,\n};\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  list.innerHTML = '';\n  const form = e.currentTarget;\n  queryParams.query = form.elements.query.value.trim();\n  loader.classList.add('loader');\n  loadMoreBtn.classList.add('is-hidden');\n  if (!queryParams.query) {\n    return;\n  }\n  try {\n    const { data } = await searchPhotos(queryParams);\n    console.log(data);\n    let markup = '';\n    const datas = data.hits;\n    for (const item of datas) {\n      markup += createMarkup(item);\n    }\n    if (datas.length === 0) {\n      iziToast.error({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: 'topRight',\n      });\n    }\n    const totalResults = data.totalHits;\n    queryParams.maxPage = Math.ceil(totalResults / queryParams.per_page);\n    list.innerHTML = markup;\n    const domRect = list.firstElementChild.getBoundingClientRect();\n\n    scrollBy({\n      top: domRect.height,\n      behavior: 'smooth',\n    });\n\n    loader.classList.remove('loader');\n    if (datas.length > 0 && datas.length !== totalResults) {\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n      loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      loadMoreBtn.classList.add('is-hidden');\n    }\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  queryParams.page += 1;\n  loader.classList.add('loader');\n  loadMoreBtn.classList.add('is-hidden');\n  try {\n    const { data } = await searchPhotos(queryParams);\n    console.log(data);\n    let markup = '';\n    const datas = data.hits;\n    for (const item of datas) {\n      markup += createMarkup(item);\n    }\n    list.innerHTML += markup;\n    const domRect = list.firstElementChild.getBoundingClientRect();\n    scrollBy({\n      top: domRect.height,\n      behavior: 'smooth',\n    });\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loader.classList.remove('loader');\n    loadMoreBtn.classList.remove('is-hidden');\n  }\n\n  if (queryParams.page === queryParams.maxPage) {\n    loadMoreBtn.classList.add('is-hidden');\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n    });\n    loadMoreBtn.removeEventListener('click', handleLoadMore);\n  }\n}\n\nasync function searchPhotos({ query, page = 1, per_page }) {\n  try {\n    const response = await axios.get(`${BASE_URL}/?`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    });\n    return response;\n  } catch (err) {\n    console.log(err);\n  }\n}\n\nfunction createMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  const markup = ` <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=${largeImageURL}>\n      <img\n        class=\"gallery-image\"\n        src=${webformatURL}\n        alt=${tags}\n        >\n  \n        <p>Likes<br> ${likes}</p>\n        <p>Views<br> ${views}</p>\n        <p>Comments<br> ${comments}</p>\n        <p>Downloads<br> ${downloads}</p>   \n    </a>\n  </li>`;\n\n  return markup;\n}\n"],"names":["BASE_URL","API_KEY","form","list","loader","loadMoreBtn","handleSearch","lightbox","SimpleLightbox","queryParams","e","data","searchPhotos","markup","datas","item","createMarkup","iziToast","totalResults","domRect","handleLoadMore","err","query","page","per_page","axios","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}